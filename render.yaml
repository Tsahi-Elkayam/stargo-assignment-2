services:
  # Bitcoin Exporter Service
  - type: web
    name: bitcoin-exporter
    env: docker
    dockerfilePath: ./Dockerfile.simple
    region: oregon
    plan: free
    envVars:
      - key: PORT
        value: 8000

  # Prometheus Service
  - type: web
    name: prometheus
    env: docker
    dockerfilePath: ./Dockerfile.prometheus
    region: oregon
    plan: free
    envVars:
      - key: PORT
        value: 9090
      - key: BITCOIN_EXPORTER_URL
        value: bitcoin-exporter.onrender.com

  # Grafana Service
  - type: web
    name: grafana
    env: docker
    dockerfilePath: ./Dockerfile.grafana
    region: oregon
    plan: free
    envVars:
      - key: GF_SERVER_HTTP_PORT
        value: 3000
      - key: PORT
        value: 3000
      - key: GF_AUTH_ANONYMOUS_ENABLED
        value: true
      - key: GF_AUTH_ANONYMOUS_ORG_ROLE
        value: Admin
      - key: GF_SECURITY_ALLOW_EMBEDDING
        value: true
      - key: PROMETHEUS_URL
        value: prometheus-xr0g.onrender.com
